<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Bá»‘c LÃ¬ XÃ¬ Niá»m Vui ğŸ§§</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#c62828">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Bá»‘c LÃ¬ XÃ¬">

<link rel="apple-touch-icon" href="./icon-192.png">

<style>
html, body {
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  overscroll-behavior:none;
  touch-action: pan-x pan-y;
  font-family:"Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg, #c62828, #f9a825);
  color:#fff;
  text-align:center;
}
.petal {
  position: fixed;
  top: -40px;
  font-size: 20px;
  opacity: .8;
  animation: fall linear infinite;
  pointer-events: none;
}
@keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }

.box {
  background: rgba(255,255,255,.18);
  padding: 26px;
  border-radius: 18px;
  max-width: 460px;
  margin: auto;
  margin-top: 30px;
}

button {
  margin: 16px;
  padding: 14px 34px;
  border:none;
  border-radius:16px;
  background:#ffeb3b;
  color:#b71c1c;
  font-weight:bold;
  font-size:18px;
  cursor:pointer;
}
button:hover { animation: shake .35s; }
@keyframes shake { 25%{transform:translateX(-3px);}50%{transform:translateX(3px);} }
button:disabled { opacity:.5; cursor:not-allowed; animation:none; }

.money-img img {
  width:220px;
  border-radius:10px;
  box-shadow:0 6px 18px rgba(0,0,0,.35);
}

.result { margin-top:20px; font-size:17px; line-height:1.7; }
</style>
</head>
<body>

<h1>ğŸ§§ Bá»C LÃŒ XÃŒ NIá»€M VUI ğŸ§§</h1>

<div class="box">
  <button id="pickBtn" onclick="pickLucky()">ğŸ Bá»C LÃŒ XÃŒ</button>
  <div id="result"></div>
</div>

<audio id="openSound">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-bonus-alert-767.mp3">
</audio>

<audio id="bgMusic" loop>
  <source src="./nhac-tet.mp3" type="audio/mpeg">
</audio>

<script>
// Hoa rÆ¡i
setInterval(() => {
  const p = document.createElement("div");
  p.className = "petal";
  p.innerText = "ğŸŒ¸";
  p.style.left = Math.random()*100 + "vw";
  p.style.animationDuration = (9 + Math.random()*6) + "s";
  document.body.appendChild(p);
  setTimeout(() => p.remove(), 15000);
}, 900);

// Lá»i chÃºc
const wishes = [
  "ChÃºc báº¡n nÄƒm má»›i luÃ´n vui váº», há»c táº­p tiáº¿n bá»™ tá»«ng ngÃ y, tá»± tin vÆ°á»£t qua má»i ká»³ thi vÃ  luÃ´n tin vÃ o chÃ­nh mÃ¬nh ğŸŒ±",
  "Mong nÄƒm má»›i mang Ä‘áº¿n tháº­t nhiá»u niá»m vui, tÃ¬nh báº¡n Ä‘áº¹p, nhá»¯ng buá»•i há»c Ä‘Ã¡ng nhá»› vÃ  tháº­t nhiá»u tiáº¿ng cÆ°á»i âœ¨",
  "ChÃºc báº¡n há»c tá»‘t hÆ¡n má»—i ngÃ y, tinh tháº§n luÃ´n thoáº£i mÃ¡i vÃ  Ä‘áº¡t Ä‘Æ°á»£c nhá»¯ng má»¥c tiÃªu mÃ¬nh mong muá»‘n ğŸš€",
  "NÄƒm má»›i chÃºc báº¡n luÃ´n khá»e máº¡nh, chÄƒm chá»‰, gáº·p nhiá»u may máº¯n vÃ  cÃ³ tháº­t nhiá»u ká»· niá»‡m Ä‘áº¹p ğŸ“š",
  "Hy vá»ng nÄƒm má»›i sáº½ lÃ  má»™t hÃ nh trÃ¬nh tuyá»‡t vá»i vá»›i báº¡n, trÃ n Ä‘áº§y nÄƒng lÆ°á»£ng tÃ­ch cá»±c vÃ  thÃ nh cÃ´ng â¤ï¸"
];

// Má»‡nh giÃ¡ + tá»‰ lá»‡
const moneyOptions = [
  { value: 10000, weight: 30 },
  { value: 20000, weight: 30 },
  { value: 50000, weight: 30 },
  { value: 100000, weight: 10 }
];

const moneyImages = {
  10000: "./anh-tien-10k.jpg",
  20000: "./anh-tien-20k.jpg",
  50000: "./anh-tien-50k.jpg",
  100000: "./anh-tien-100k.jpg"
};

// HÃ m random theo weight
function pickMoneyByWeight() {
  const totalWeight = moneyOptions.reduce((sum, opt) => sum + opt.weight, 0);
  let rand = Math.random() * totalWeight;
  for (let opt of moneyOptions) {
    if (rand < opt.weight) return opt.value;
    rand -= opt.weight;
  }
  return moneyOptions[moneyOptions.length-1].value;
}

let turns = 0, maxTurns = 6, musicStarted = false;

function pickLucky() {
  if (!musicStarted) { 
    bgMusic.volume = 0.35; 
    bgMusic.play(); 
    musicStarted = true;
  }
  if (turns >= maxTurns) return;

  const resultEl = document.getElementById("result");

  // Hiá»ƒn thá»‹ loader ngay láº­p tá»©c
  resultEl.innerHTML = `<p style="font-size:18px; margin-top:20px;">ğŸK HÆ°ng Ä‘ang phÃ¡t quÃ  cho báº¡nâ€¦</p>`;
  resultEl.style.opacity = 1;

  confetti({ particleCount: 60, spread: 60, origin: { y: 0.6 } });
  openSound.play();

  // Sau 1.2s má»›i hiá»‡n káº¿t quáº£
  setTimeout(() => {
    const wish = wishes[Math.floor(Math.random() * wishes.length)];
    const money = pickMoneyByWeight();
    const moneyImg = moneyImages[money];

    resultEl.innerHTML = `
      <div class="money-img">
        <img src="${moneyImg}" alt="LÃ¬ xÃ¬ ${money.toLocaleString()}Ä‘">
      </div>
      <p><b>${wish}</b></p>
      <p>ğŸ§§ LÃ¬ xÃ¬ may máº¯n: <b>${money.toLocaleString()}Ä‘</b></p>
    `;
    confetti({ particleCount: 120, spread: 90, origin: { y: 0.6 } });

    turns++;
    if (turns === maxTurns) {
      pickBtn.disabled = true;
      setTimeout(() => {
        resultEl.innerHTML = "<h2>ğŸ‰ CHÃšC Má»ªNG NÄ‚M Má»šI ğŸ‰</h2>";
        confetti({ particleCount: 200, spread: 120 });
      }, 2500);
    }
  }, 1200);
}

/* PWA */
if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js');}
</script>

</body>
</html>
